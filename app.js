const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),img=new Image;img.src="assets/assets-img.png";let gamePlaying=!1;const gravity=.5,speed=5.8,size=[50,36],jump=-10,cTenth=canvas.width/10;let flight,flyHeight,currentScore,pipe,index=0,bestScore=0;const pipeWidth=78,pipeGap=280,pipeLoc=()=>Math.random()*(canvas.height-(pipeGap+pipeWidth)-pipeWidth)+pipeWidth,setup=()=>{currentScore=0,flight=jump,flyHeight=canvas.height/2-size[1]/2,pipes=[,,,].fill().map((b,a)=>[canvas.width+a*(pipeGap+pipeWidth),pipeLoc()])},render=()=>{index++,ctx.drawImage(img,0,0,canvas.width,canvas.height,-(index*(speed/2)%canvas.width)+canvas.width,0,canvas.width,canvas.height),ctx.drawImage(img,0,0,canvas.width,canvas.height,-(index*(speed/2))%canvas.width,0,canvas.width,canvas.height),gamePlaying&&pipes.map(a=>{a[0]-=speed,ctx.drawImage(img,432,588-a[1],pipeWidth,a[1],a[0],0,pipeWidth,a[1]),ctx.drawImage(img,510,108,pipeWidth,canvas.height-a[1]+pipeGap,a[0],a[1]+pipeGap,pipeWidth,canvas.height-a[1]+pipeGap),a[0]<=-78&&(currentScore++,bestScore=Math.max(bestScore,currentScore),pipes=[...pipes.slice(1),[pipes[pipes.length-1][0]+pipeGap+pipeWidth,pipeLoc()]],console.log(pipes)),[a[0]<=cTenth+size[0],a[0]+pipeWidth>=cTenth,a[1]>flyHeight||a[1]+pipeGap<flyHeight+size[1]].every(a=>a)&&(gamePlaying=!1,setup())}),gamePlaying?(ctx.drawImage(img,432,Math.floor(index%9/3)*size[1],...size,cTenth-size[0]/2,flyHeight-size[1]/2,...size),flight+=gravity,flyHeight=Math.min(flyHeight+flight,canvas.height-size[1])):(ctx.drawImage(img,432,Math.floor(index%9/3)*size[1],...size,canvas.width/2-size[0]/2,flyHeight,...size),flyHeight=canvas.height/2-size[1]/2,ctx.fillText(`Best score : ${bestScore}`,85,245),ctx.fillText("Click to play",100,535),ctx.font="bold 30px Bricolage Grotesque",ctx.fillStyle="white"),document.getElementById("bestScore").innerHTML=`Best Score : ${bestScore}`,document.getElementById("currentScore").innerHTML=`Score : ${currentScore}`,window.requestAnimationFrame(render)};setup(),img.onload=render,document.addEventListener("click",()=>gamePlaying=!0),window.onclick=()=>flight=jump;